const SubmitForm={data:null,serie:null,supertype:null,type:null,dnd:null,desc:null,submitbtn:null,init:function(t){this.data=t,this.dnd=document.getElementById("dnd"),this.serie=document.getElementById("serie"),this.supertype=document.getElementById("supertype"),this.type=document.getElementById("type"),this.desc=document.getElementById("desc"),this.submitbtn=document.getElementById("submit-btn"),this.fillSerie(t.series),this.fillSuperType(t.supertypes),this.fillType(t.types),DropImage.init(this.dnd),HintSymbols.init(),MTGEditor.init(this.desc)},fillSerie:function(t){t.forEach((t=>{const e=create("option");e.innerText=t,e.value=t,this.serie.append(e)}))},fillSuperType:function(t){t.forEach((t=>{const e=create("option");e.innerText=t,e.value=t,this.supertype.append(e)}))},fillType:function(t){t.forEach((t=>{const e=create("option");e.innerText=t,e.value=t,this.type.append(e)}))},progress:function(t){console.log(t),this.submitbtn.disabled=t<1}};window.SubmitForm=SubmitForm;const HintSymbols={symbols:["U","G","B","W","R","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","2B","2G","2R","2U","2W","BG","BR","GU","GW","RG","RW","UB","UR","WB","WU","X","Y","Z"],hintBox:null,input:null,cost:null,init:function(){this.hintBox=document.body.create("div","card-submit-cost-symbols"),this.input=document.getElementById("costInput"),this.cost=document.getElementById("costRender"),this.symbols.forEach((t=>{this.hintBox.create("div","symbol24 icon-"+t).bind("click",(e=>{this.input.value+="{"+t+"}",this.renderCost()}))})),this.input.bind("input",(t=>{this.renderCost()}));let t=!1;this.input.addEventListener("focus",(()=>{this.hintBox.style.display="block",this.hintBox.style.visibility="hidden";const t=this.input.getBoundingClientRect(),e=this.hintBox.offsetHeight;this.hintBox.style.left=t.left+window.scrollX+"px",this.hintBox.style.top=t.top+window.scrollY-e-8+"px",this.hintBox.style.visibility="visible"})),this.input.addEventListener("blur",(()=>{t||(this.hintBox.style.display="none")})),this.hintBox.addEventListener("mousedown",(()=>{t=!0})),this.hintBox.addEventListener("mouseup",(()=>{setTimeout((()=>{t=!1,this.input.focus()}),0)}))},renderCost:function(){let t="";[...this.input.value.matchAll(/\{(.*?)\}/g)].map((t=>t[1])).forEach((e=>{t+=`<div class="symbol24 icon-${e}"></div>`})),this.cost.innerHTML=t}},DropImage={div:null,value:null,init:function(t){this.div=t,this.div.addEventListener("dragover",(t=>{t.preventDefault(),this.div.classList.add("dragover")})),this.div.addEventListener("dragleave",(()=>{this.div.classList.remove("dragover")})),this.div.addEventListener("drop",(t=>{t.preventDefault(),this.div.classList.remove("dragover");const e=t.dataTransfer.files;e.length>0&&this.handleFile(e[0])})),this.div.addEventListener("click",(t=>{browse("image/*",(t=>{t.target.files.length>0&&this.handleFile(t.target.files[0])}))}))},handleFile:function(t){if(t.type.startsWith("image/")&&t.size<=5242880){const e=new FileReader;e.onload=t=>{this.value=t.target.result,this.div.style.setProperty("--bg-image",`url("${t.target.result}")`)},e.readAsDataURL(t)}}},MTGEditor={symbols:["I","U","G","B","W","R","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","2B","2G","2R","2U","2W","BG","BR","GU","GW","RG","RW","UB","UR","WB","WU","X","Y","Z","T","T1","T2"],toolbar:null,elm:null,init:function(t){this.elm=t,this.toolbar=create("div","MTGEditor-toolbar"),this.elm.parentElement.insertBefore(this.toolbar,this.elm),this.symbols.forEach((t=>{this.toolbar.create("div","symbol24 icon-"+t).bind("click",(e=>{"I"==t?this.wrapItalic():this.insert("{"+t+"}")}))}))},insert:function(t){const e=this.elm.selectionStart,i=this.elm.selectionEnd,s=this.elm.value.substring(0,e),n=this.elm.value.substring(i);this.elm.value=s+t+n;const l=e+t.length;this.elm.selectionStart=this.elm.selectionEnd=l,this.elm.focus()},wrapItalic:function(){const t=this.elm.selectionStart,e=this.elm.selectionEnd,i=this.elm.value.substring(t,e);let s,n;i.length>0?(s=`{I}${i}{/I}`,n=t+s.length):(s="{I}{/I}",n=t+3);const l=this.elm.value.slice(0,t),o=this.elm.value.slice(e);this.elm.value=l+s+o,this.elm.selectionStart=this.elm.selectionEnd=n,this.elm.focus()}};